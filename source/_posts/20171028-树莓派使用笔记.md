---
title: æ ‘è“æ´¾é£Ÿç”¨æŒ‡å—
urlname: How2EatRaspberry
date: 2017-10-28 19:39:14
tags: [Hardware, RaspberryPi]
---
<link href="/css/myCSS.css" rel="stylesheet" type="text/css">

å¯¹äºå…¥æ‰‹[æ ‘è“æ´¾](https://zh.wikipedia.org/wiki/%E6%A0%91%E8%8E%93%E6%B4%BE) æ˜¯è“„è°‹å·²ä¹…ğŸ™ƒç°åœ¨å¦‚æ„¿ä»¥å¿ã€‚</i>

æœ¬æ–‡æ•´ç†äº†ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜ã€‚

<!--more-->

![raspberry](https://cdn.safeandsound.cn/image/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%85%A5%E9%97%A8/raspberry.jpg)

### ç›’å­
åœ¨å®é™…ä½¿ç”¨ä¹‹å‰å»ºè®®ä½ ä¹°ä¸€ä¸ªç›’å­, å› ä¸ºæ ‘è“æ´¾æœ¬èº«åªæœ‰ä¸€å—æ¿å­, å¦‚æœæ¿å­å‘ç”Ÿå¼¯æ›²çš„è¯é‡Œé¢çš„å°åˆ¶çº¿è·¯å¾ˆå¯èƒ½ä¼šè¢«æŠ˜æ–­(æ ‘è“æ´¾çš„çº¿è·¯æ˜¯å¤šå±‚å‹åˆ¶åœ¨ä¸€èµ·çš„,åƒä¸€å—ä¸‰æ˜æ²»ä¸€æ ·), è€Œä¸”å¾ˆå¤šç„Šç‚¹å’Œç»„ä»¶å¾ˆå¯èƒ½å› ä¸ºä½ çš„æ“ä½œä¸å½“(æ¯”å¦‚æŠŠå®ƒæ”¾åœ¨é“è´¨æ¡Œå­è¿™ç§å¯¼ä½“ä¸Š)è€Œå‘ç”ŸçŸ­è·¯, æœ‰äº†ç›’å­ä¹Ÿå°±å¤šäº†ä¸€å±‚ä¿æŠ¤. 

### å®‰è£…ç³»ç»Ÿ
* #### ä¸‹è½½é•œåƒ
raspberryPiå®˜æ–¹çš„é•œåƒé›†åˆ[åœ¨è¿™é‡Œ](https://www.raspberrypi.org/downloads/)ï¼Œkaliçš„é•œåƒ[åœ¨è¿™é‡Œ](https://www.offensive-security.com/kali-linux-arm-images/)
* #### å®‰è£…
å®‰è£…ç³»ç»Ÿçš„ç½‘ä¸Šæ•™ç¨‹å¾ˆå¤šï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯Raspbianç³»ç»Ÿ,ç”¨rufusç›´æ¥çƒ§å½•è¿›å»tfå¡é‡Œï¼›å½“ç„¶ä¹Ÿå¯ä»¥å°†é•œåƒçƒ§å½•åˆ°Uç›˜ï¼Œç„¶åå¼€æœºè¿›biosä»Uç›˜å®‰è£…ç³»ç»Ÿï¼Œè¿™ç§æ–¹æ³•éœ€è¦ä½¿ç”¨æ˜¾ç¤ºå™¨å’Œæœ‰çº¿é”®ç›˜ã€‚

### æŒ‡ç¤ºç¯ç®€ä»‹
æ ‘è“æ´¾ä¸Šé™¤äº†rj45ç½‘å£çš„ledæŒ‡ç¤ºç¯ï¼ˆspeed ledã€é»„ç¯ã€‘ï¼šé•¿äº®ä»£è¡¨100Mæˆ–è€…æ›´é«˜é€Ÿçš„ç½‘å¡ï¼Œä¸äº®ä»£è¡¨10Mç½‘å¡ï¼Œä½†æœ‰äº›åƒå…†ç½‘å¡çš„ç¯ä»¥é¢œè‰²åŒºåˆ†ï¼Œä¸äº®ä»£è¡¨10M/100Mï¼Œé»„è‰²å¸¸äº®ä»£è¡¨1000Mï¼›active ledã€ç»¿ç¯ã€‘ï¼šç¯ç­ä»£è¡¨æœªè¿æ¥ï¼Œé•¿äº®ä»£è¡¨å·²è¿æ¥ä¸Šä½†æ— æ•°æ®æ”¶å‘ï¼Œé—ªçƒä»£è¡¨æœ‰æ•°æ®æ”¶å‘ï¼‰å¤–åœ¨ç”µæºæ¥å£å¤„è¿˜æœ‰ä¸¤ä¸ªçŠ¶æ€ç¯ï¼Œä¸€ä¸ªçº¢ç¯ä¸€ä¸ªç»¿ç¯ï¼Œçº¢ç¯æ˜¯ç”µæºç¯ï¼Œæ¥é€šåå¸¸äº®ï¼Œå¦‚æœé—ªçƒè¯´æ˜å½“å‰ç”µæºä¸ç¨³å®šï¼›ç»¿ç¯æ˜¯è¯»å†™æŒ‡ç¤ºç¯ï¼Œåœ¨å­˜å‚¨å¡å‘ç”Ÿæ•°æ®è¯»å†™æ—¶é—ªçƒï¼Œå¦åˆ™ç†„ç­ï¼Œä»¥æ­¤æ¥åˆ¤æ–­å½“å‰æ˜¯å¦å‘ç”Ÿæ•°æ®è¯»å†™ã€‚

### è¿æ¥
**æ³¨:** ç³»ç»Ÿé»˜è®¤sshæœåŠ¡ä¸éšæœºè‡ªå¯åŠ¨ï¼Œæˆ‘ä»¬å°†tfå¡æ’åœ¨ç¬”è®°æœ¬ä¸Šï¼Œåœ¨æ˜¾ç¤ºå‡ºçš„bootåˆ†åŒºä¸­åˆ›å»ºä¸€ä¸ªåä¸º`ssh`çš„ç©ºç™½æ–‡ä»¶æ¥è§¦å‘sshæœåŠ¡çš„å¼€å¯

#### ç½‘çº¿ç›´è¿ç¬”è®°æœ¬
æˆ‘é‡‡ç”¨çš„æ–¹å¼æ˜¯ç¬”è®°æœ¬ç½‘çº¿ç›´è¿æ ‘è“æ´¾ï¼Œç„¶åå°†ç¬”è®°æœ¬æ— çº¿ç½‘å¡çš„ç½‘ç»œå…±äº«ç»™ä»¥å¤ªç½‘å¡ï¼Œè¿™æ ·ä¸ä»…æ ‘è“æ´¾èƒ½å¤Ÿä¸Šç½‘ï¼Œæˆ‘ä¹Ÿèƒ½sshåˆ°æ ‘è“æ´¾ã€‚

ç½‘çº¿è¿æ¥å¥½ã€æ ‘è“æ´¾ä¸»æ¿åŠ ç”µå¯åŠ¨ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨arpå‘½ä»¤æ‰«æä¸€ä¸‹æœ¬åœ°çš„macä¸ipæ˜ å°„è¡¨ï¼Œå¹¶æŠ“å–å‡ºæ ‘è“æ´¾çš„åœ°å€æ˜ å°„ï¼š

```cmd
C:\Users\jay> arp -a |findstr "b8-27-eb"
192.168.137.232       b8-27-eb-8e-9e-fe     é™æ€
```

"b8-27-eb"æ˜¯æ ‘è“æ´¾ç½‘å¡macåœ°å€çš„å‰ä¸‰ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯æ ‘è“æ´¾åˆ¶é€ å•†çš„[OUIï¼ˆç»„ç»‡å”¯ä¸€è¯†åˆ«ç¬¦ï¼‰](https://en.wikipedia.org/wiki/Organizationally_unique_identifier)ï¼Œä»IEEEå®˜æ–¹æä¾›çš„[OUI](http://standards-oui.ieee.org/oui.txt)åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥è¯¢åˆ°ã€‚

è·å–åˆ°ipåæˆ‘ä»¬ä½¿ç”¨sshè¿æ¥ï¼Œé»˜è®¤ç”¨æˆ·åä¸ºpiï¼Œå¯†ç ä¸ºraspberryã€‚

**æ³¨:** å¦‚æœé‡åˆ°ç¬”è®°æœ¬èƒ½è¿æ¥æ ‘è“æ´¾ä½†æ˜¯æ ‘è“æ´¾æ— æ³•ä¸Šç½‘çš„æƒ…å†µ(å³ä»…æœ¬åœ°å±€åŸŸç½‘å¯è®¿é—®), è¯·å°†ç¬”è®°æœ¬æ— çº¿ç½‘å¡å±æ€§é‡Œçš„å…±äº«å…ˆå–æ¶ˆ, ä¿å­˜å, å†é‡æ–°å¼€å¯å…±äº«, å¦‚æœè¿˜ä¸è¡Œçš„è¯å°±å…ˆå–æ¶ˆå…±äº«å†ç¦ç”¨ç¬”è®°æœ¬æ— çº¿ç½‘å¡, å†å¯ç”¨æ— çº¿ç½‘å¡å¹¶å¼€å¯å…±äº«.

#### wifiè‡ªåŠ¨è¿æ¥
å¦‚æœç¬¬ä¸€æ¬¡å¯åŠ¨çš„æ—¶å€™æ‰‹è¾¹æ²¡æœ‰ç½‘çº¿ï¼Œä½†æ˜¯æœ‰è·¯ç”±å™¨, æˆ–è€…æ‰‹æœºå¯ä»¥å¼€çƒ­ç‚¹ï¼Œå¯ä»¥é…ç½®Wi-Fiè¿æ¥ã€‚

å’Œç¬¬ä¸€æ¬¡å¼€æœºè§¦å‘SSHæœåŠ¡çš„æ–¹æ³•ä¸€æ ·ï¼Œå°†tfå¡æ’åœ¨ç¬”è®°æœ¬ä¸Šï¼Œåœ¨æ˜¾ç¤ºå‡ºçš„bootåˆ†åŒºä¸­å»ºç«‹åä¸º`wpa_supplicant.conf`çš„æ–‡ä»¶ï¼Œé‡Œé¢æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š

```
country=GB
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
network={
  ssid="Wi-Fiåç§°"
  psk="Wi-Fiå¯†ç "
  priority=å¡«å†™æ•°å­—ï¼Œæ•°å­—è¶Šå¤§ä»£è¡¨ä¼˜å…ˆçº§è¶Šé«˜
}
```

æ·»åŠ çš„é…ç½®ä¼šåœ¨ç³»ç»Ÿçš„`/etc/wpa_supplicant/wpa_supplicant.conf`é…ç½®æ–‡ä»¶é‡Œ.

æ ‘è“æ´¾ä¸»æ¿åŠ ç”µï¼Œç¨ç­‰å‡ åˆ†é’Ÿï¼Œå°±ä¼šè¿ä¸ŠWi-Fiäº†ã€‚

**æ³¨:**è¯·æ³¨æ„wifiçš„é¢‘ç‡, æ ‘è“æ´¾åªæœ‰2018å¹´å‘å¸ƒçš„3b+ç‰ˆæœ¬æ‰æ”¯æŒ5Ghzçš„é¢‘å¸¦, ä¹‹å‰çš„éƒ½åªæ”¯æŒ2.4G, å¦‚æœä½ çš„wifiæ˜¯5G, é‚£ä¹ˆè€ç‰ˆçš„æ ‘è“æ´¾æ˜¯è¯†åˆ«ä¸äº†çš„.

### è¿æ¥æ˜¾ç¤ºå™¨é‡åˆ°çš„é—®é¢˜
æˆ‘æœ‰ä¸€æ¬¡åœ¨è¿æ¥æ˜¾ç¤ºå™¨çš„æ—¶å€™çªç„¶é»‘å±äº†ï¼Œåœ¨ç½‘ä¸Šæœç´¢ä¸€ä¸‹åå¾—çŸ¥éœ€è¦ä¿®æ”¹bootç›®å½•ä¸‹çš„config.txtæ–‡ä»¶ï¼Œå°†hdmi_safe=1çš„æ³¨é‡Šå–æ¶ˆæ‰ã€‚å¯ä»¥å‚è€ƒ[è¯¥æ•™ç¨‹](http://wangye.org/blog/archives/762/)è§£å†³ä½¿ç”¨æ˜¾ç¤ºå™¨çš„é—®é¢˜

### ä½¿ç”¨rootè´¦å·
rootè´¦å·é»˜è®¤æœªå¯ç”¨ï¼Œå¦‚æœè¦ä½¿ç”¨rootè´¦å·ï¼Œæˆ‘ä»¬éœ€è¦:

```shell
#è®¾ç½®rootè´¦å·å¯†ç 
sudo passwd root
#å¯ç”¨rootè´¦å·
sudo passwd --unlock root
```

å¦‚éå¿…è¦ä¸å»ºè®®ä½¿ç”¨ï¼Œæ¯•ç«Ÿè´¦å·piä½¿ç”¨sudoæ— éœ€è¾“å…¥å‘½ä»¤ï¼Œæ–¹ä¾¿çš„åŒæ—¶ä¹Ÿæ›´å®‰å…¨ã€‚

### ç½‘ç»œ
#### æ‰‹åŠ¨è¿æ¥wifi
é¦–å…ˆéœ€è¦å¼€å¯æ— çº¿ç½‘å¡, ä½¿ç”¨å‘½ä»¤`iw dev|grep Interface`æŸ¥çœ‹æ— çº¿ç½‘å¡åç§°, ä¸€èˆ¬ä¸º`wlan0`
ç„¶å`ifconfig`æŸ¥çœ‹è¯¥ç½‘å¡æ˜¯å¦å·²ç»å¯åŠ¨, å¦‚æœæ²¡æœ‰æ˜¾ç¤ºæ— çº¿ç½‘å¡çš„è¯ä½¿ç”¨`ifconfig æ— çº¿ç½‘å¡å up`å‘½ä»¤å¯åŠ¨ç½‘å¡

ä½¿ç”¨`iw æ— çº¿ç½‘å¡å scan |grep SSID`æŸ¥çœ‹æ¿å­èƒ½å¤Ÿæ‰«æåˆ°çš„wifiåç§°, å¯ä»¥çœç•¥grepå‘½ä»¤æ¥æŸ¥çœ‹çƒ­ç‚¹çš„è¯¦ç»†ä¿¡æ¯

* å¦‚æœæˆ‘ä»¬çš„çƒ­ç‚¹æ²¡æœ‰åŠ å¯†çš„è¯, é‚£ä¹ˆç›´æ¥ä½¿ç”¨å‘½ä»¤`iw wlan0 connect SSID`

* å¦‚æœçƒ­ç‚¹æ˜¯ä½¿ç”¨WEPåŠ å¯†æ–¹å¼çš„è¯, å¯ä»¥ä½¿ç”¨å‘½ä»¤`iw wlan0 connect SSID key 0:[å¯†ç ]`

* å¦‚æœçƒ­ç‚¹æ˜¯ä½¿ç”¨WPAæˆ–WPA2åŠ å¯†çš„, é‚£ä¹ˆå¯ä»¥ç›´æ¥ç¼–è¾‘`/etc/wpa_supplicant/wpa_supplicant.conf`æ–‡ä»¶ï¼Œåœ¨åé¢è¿½åŠ 

```
network={
  ssid="Wi-Fiåç§°"
  psk="Wi-Fiå¯†ç "
  priority=å¡«å†™æ•°å­—ï¼Œæ•°å­—è¶Šå¤§ä»£è¡¨ä¼˜å…ˆçº§è¶Šé«˜
}
#å¦‚æœæœ‰å¤šä¸ªå¯é€‰wifiå¯ä»¥ç»§ç»­æ·»åŠ 
network={
  ssid="ç¬¬äºŒä¸ªWi-Fiçš„åç§°"
  psk="ç¬¬äºŒä¸ªWi-Fiçš„å¯†ç "
  priority=å¡«å†™æ•°å­—ï¼Œæ•°å­—è¶Šå¤§ä»£è¡¨ä¼˜å…ˆçº§è¶Šé«˜
}
network={
  ssid="ç¬¬ä¸‰ä¸ªWi-Fiçš„åç§°"
  psk="ç¬¬ä¸‰ä¸ªWi-Fiçš„å¯†ç "
  priority=è¿™é‡Œå¡«å†™æ•°å­—ï¼Œæ•°å­—è¶Šå¤§ä»£è¡¨ä¼˜å…ˆçº§è¶Šé«˜
}
#ä»¥æ­¤ç±»æ¨
```

ä¿å­˜è®¾ç½®å, ä½¿ç”¨å‘½ä»¤`wpa_supplicant -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf`è¿›è¡Œå¯ç”¨, ä¼šæŒ‰ç…§é…ç½®æ–‡ä»¶ä¸­çš„ä¼˜å…ˆçº§è¿›è¡Œé¡ºåºé€‰æ‹©(å¦‚æœè¯¥çƒ­ç‚¹æœç´¢å¾—åˆ°çš„è¯). è¿æ¥æˆåŠŸçš„è¯ä¼šå‡ºç°å¦‚ä¸‹log:

```
Successfully initialized wpa_supplicant
p2p-dev-wlan0: CTRL-EVENT-REGDOM-CHANGE init=USER type=COUNTRY alpha2=GB
wlan0: Trying to associate with e2:ac:cb:bd:d1:37 (SSID='jay' freq=2437 MHz)
wlan0: Associated with e2:ac:cb:bd:d1:37
wlan0: WPA: Key negotiation completed with e2:ac:cb:bd:d1:37 [PTK=CCMP GTK=CCMP]
wlan0: CTRL-EVENT-CONNECTED - Connection to e2:ac:cb:bd:d1:37 completed [id=0 id_str=]
p2p-dev-wlan0: CTRL-EVENT-REGDOM-CHANGE init=CORE type=WORLD
```

å¦‚æœå‡ºç°`ctrl_iface exists and seems to be in use - cannot override it`çš„æŠ¥é”™, è¯´æ˜å·²ç»æœ‰wpa_supplicantçš„è¿›ç¨‹å­˜åœ¨äº†, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`netstat -anp|grep supplicant`æŸ¥å‡ºç›¸åº”çš„pidæ€æ‰å³å¯.

####  é™æ€ip
æœ‰äº›æ—¶å€™ä½ æ‹”ä¸‹ç½‘çº¿åé‡æ–°æ’å›å»ï¼Œä¼šå¯¼è‡´æ ‘è“æ´¾é‡æ–°è·å–ipï¼Œé‡åˆ°å¦‚ä¸‹çš„å°´å°¬æƒ…å†µ

```
 C:\Users\jay> arp -a |findstr "b8-27-eb"
192.168.137.232       b8-27-eb-8e-9e-fe     é™æ€
192.168.137.240       b8-27-eb-8e-9e-fe     é™æ€
```

å‡ºç°äº†ä¸¤ä¸ªåœ°å€æ˜ å°„,è¿™æ˜¯å› ä¸ºé‡æ–°æ’å›å»åæ ‘è“æ´¾è¢«åˆ†é…äº†ä¸€ä¸ªæ–°çš„ip,è€Œä¹‹å‰çš„åœ°å€æ˜ å°„è¿˜å­˜åœ¨arpåœ°å€æ˜ å°„è¡¨ä¸­,æ‰€ä»¥å°±å‡ºç°äº†ä¸¤ä¸ªç»“æœ.
æˆ‘ä»¬å¯ä»¥ç¼–è¾‘dhcpcd.confé…ç½®æ–‡ä»¶æ¥ä¸»åŠ¨è·å–é™æ€ip

```
sudo vi /etc/dhcpcd.conf
```

åœ¨æ–‡ä»¶ä¸­æ·»åŠ ï¼ˆå¦‚æœå«Œå¼„ä¹±æ–‡ä»¶å¯ä»¥æœç´¢"profile static_eth0"è¿™ä¸ªpatternç„¶ååœ¨åé¢è¿›è¡Œä¿®æ”¹ï¼‰

```
#æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µæ¥ï¼Œä»¥ä¸‹åªæ˜¯æˆ‘çš„é…ç½®ï¼Œä»…ä¾›å‚è€ƒ
interface eth0
static ip_address=192.168.137.232/24
static routers=192.168.137.1
static domain_name_servers=192.168.137.1
```

å®Œæˆåé‡å¯networkæœåŠ¡å³å¯

### æ¢æº
å›½å¤–æºé€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢, å»ºè®®æ¢æˆå›½å†…çš„, æ¨èä¸­ç§‘å¤§å’Œæ¸…åçš„æº ğŸ‘‡

* [ä¸­ç§‘å¤§Raspberrypiæºä½¿ç”¨å¸®åŠ©](https://mirrors.ustc.edu.cn/help/archive.raspberrypi.org.html#raspberrypi)

* [æ¸…åRaspbiané•œåƒä½¿ç”¨å¸®åŠ©](https://mirror.tuna.tsinghua.edu.cn/help/raspbian/)