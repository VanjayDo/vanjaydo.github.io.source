---
title: Appveyorå…¥é—¨ç¬”è®°
urlname: Introduction2Appveyor
date: 2017-11-10 00:23:07
tags: [CI, Tips+Tricks]
---

ä¹‹å‰å¯¹äºå¤‡ä»½hexoæ­å»ºçš„åšå®¢æºç é‡‡ç”¨çš„æ–¹å¼æ˜¯åœ¨Github Pageså¯¹åº”çš„åº“ä¸­æ–°å¼€ä¸€ä¸ªåˆ†æ”¯ï¼Œæ¯å½“æºç æœ‰é‡è¦çš„å®¢åˆ¶åŒ–å˜æ›´æ—¶éƒ½æ¨ä¸€æ¬¡åˆ°å¤‡ä»½çš„åˆ†æ”¯ä¸Šï¼Œä½†æ˜¯è¿™æ ·å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½åŠæ³•ï¼Œå› ä¸ºï¼Œä½†æ˜¯æ–°å¼€ä¸€ä¸ªåº“ä¸“é—¨å­˜æºç çš„è¯åˆä¸æƒ³æ¯ä¸€æ¬¡æ›´æ–°æ—¶æ¨ä¸¤æ¬¡ï¼ˆä¸€æ¬¡åˆ°æºç åº“ï¼Œä¸€æ¬¡åˆ°GitHub Pagesçš„é™æ€é¡µé¢åº“ï¼‰æ€ä¹ˆåŠï¼Ÿç­”æ¡ˆå°±æ˜¯ä½¿ç”¨CIã€‚æˆ‘ä»¬ç›´æ¥æ¨æºç çš„æ›´æ–°åˆ°æºç åº“ï¼Œç„¶åè®©CIå·¥å…·è‡ªåŠ¨æ‹‰å–æºç ç”Ÿæˆé™æ€é¡µé¢åå†è‡ªåŠ¨æ¨åˆ°é™æ€é¡µé¢åº“ä¸­ã€‚å¦‚é¢˜ï¼Œè¿™é‡Œé‡‡ç”¨çš„CIå·¥å…·æ˜¯appveyorã€‚
![Appveyor logo](https://cdn.safeandsound.cn/image/appveyor%E5%85%A5%E9%97%A8/AppVeyorLogo.png)

<!--more-->

# ä¸€. appveyorç®€ä»‹
[appveyor](https://www.appveyor.com/)çš„ç‰¹ç‚¹å°±æ˜¯æ“ä½œå…¨éƒ¨ä¸Šäº‘, ä¸ç”¨æˆ·å¹³å°æ— å…³, ä½ å¯ä»¥åœ¨é‡‡ç”¨æœ¬åœ°`appveyor.yml`é…ç½®æ–‡ä»¶(ä»£ç æ‰˜ç®¡æ–¹[å¦‚github]å¿…é¡»æä¾›äº†ç›¸å…³API)æˆ–åœ¨appveyoré¡¹ç›®é‡Œé…ç½®ä¸¤ç§æ–¹å¼å¯¹ä½ çš„CIé¡¹ç›®è¿›è¡Œé…ç½®, é¡¹ç›®ä¼šè¿è¡Œåœ¨å®˜æ–¹é¢„å®‰è£…äº†å¾ˆå¤šè½¯ä»¶çš„è™šæ‹Ÿæœºä¸­; é¡¹ç›®æŒ‰ç…§ä½ çš„é…ç½®buildå®Œæˆåä¼šå°†ç»“æœä»¥é‚®ä»¶çš„æ–¹å¼åé¦ˆç»™ä½ (æœ‰æ—¶å»¶è¿Ÿæ¯”è¾ƒå¤§, éœ€è¦ç­‰ä¸ªäºŒä¸‰ååˆ†é’Ÿ).
![Alt text](https://cdn.safeandsound.cn/image/appveyor%E5%85%A5%E9%97%A8/appveyor2.png)

åæ­£æˆ‘ä¸ªäººæ„Ÿè§‰éå¸¸å¥½ç”¨, éå¸¸éå¸¸å¥½ç”¨, å—¯!
å…·ä½“çš„è¯·è‡ªå·±å»äº†è§£å§.

# äºŒ. åŸºæœ¬ä½¿ç”¨
é¦–å…ˆå½“ç„¶æ˜¯æ³¨å†Œè´¦å·äº†, ç”¨githubè´¦å·ç™»å½•å°±å¥½äº†(åæ­£åé¢ä¹Ÿæ˜¯è¦ç»‘å®šçš„).

## åˆ›å»ºä¸€ä¸ªé¡¹ç›®
è¿™é‡Œä»¥GitHubä¸Šçš„é¡¹ç›®ä¸ºä¾‹è®²ä¸€ä¸‹push commitåˆ°GitHubä»“åº“åappveyorè‡ªåŠ¨æ‹‰å–é¡¹ç›®å¹¶è¿›è¡Œæ“ä½œçš„è¿‡ç¨‹:
1. ç™»å½•ä¸Šå»åç‚¹[NEW PROJECT](https://ci.appveyor.com/projects/new)æ·»åŠ é¡¹ç›®;
2. åœ¨GitHubè´¦æˆ·é‡Œé€‰æ‹©é¡¹ç›®, ç‚¹å‡»`ADD`
	![é€‰æ‹©é¡¹ç›®](https://cdn.safeandsound.cn/image/appveyor%E5%85%A5%E9%97%A8/appveyor0.png)
3. åœ¨GitHubä»“åº“é‡Œæ·»åŠ appveyor.ymlé…ç½®æ–‡ä»¶, å› ä¸ºé…ç½®çš„é€‰é¡¹æœ‰å¾ˆå¤š, å…·ä½“çš„å†™æ³•è¯·æŸ¥çœ‹[appveyoræ–‡æ¡£](https://www.appveyor.com/docs/), è¿™é‡Œåªä¸¾ä¸€ä¸ªå¾ˆç®€å•çš„ä¾‹å­:appveyorè‡ªåŠ¨æ‹‰å–githubé¡¹ç›®å, åœ¨buildä¹‹å‰åˆ—ä¸€ä¸‹å½“å‰ç›®å½•é‡Œçš„æ–‡ä»¶, ç„¶ååœ¨buildè¿‡ç¨‹ä¸­åªæ‰“å°ä¸€å¥"this is just a test".
æˆ‘ä»¬åœ¨GitHubä»“åº“çš„æ ¹ç›®å½•é‡Œæ·»åŠ ä¸€ä¸ªæ–‡ä»¶, å–åä¸ºappveyor.yml, ç„¶ååœ¨é‡Œé¢è¾“å…¥:

```
	before_build:
	  - dir
	build_script:
	  - echo "this is just a test"
```

ç„¶åä¿å­˜, commitå³å¯.
éšåæˆ‘ä»¬åˆ°appveyoré¡¹ç›®ç•Œé¢å¯ä»¥çœ‹åˆ°å·²ç»è‡ªåŠ¨åœ¨è¿è¡Œäº†, consoleé‡Œä¼šæ‰“å°å‡ºå¦‚ä¸‹ç±»ä¼¼å†…å®¹

```
Build started
git clone -q --branch=master https://github.com/VanjayDo/test.git C:\projects\test
git checkout -qf 65d495665aae3ead5e4ddc06c88a67246847b621
dir
 Volume in drive C is Windows
 Volume Serial Number is D4AB-4044
 Directory of C:\projects\test
12/12/2017  01:54 AM    <DIR>          .
12/12/2017  01:54 AM    <DIR>          ..
12/12/2017  01:54 AM                68 appveyor.yml
               1 File(s)             68 bytes
               2 Dir(s)  40, 973, 512, 704 bytes free
echo "this is just a test"
"this is just a test"
Discovering tests...OK
Build success
```

è¿™å°±ç®—æ˜¯ä¸€ä¸ªæˆåŠŸçš„ä¾‹å­äº†, æ•´ä¸ªé…ç½®æ–‡ä»¶å¾ˆç®€å•, å¦‚æœéœ€è¦æ¯”è¾ƒå¤æ‚çš„æ“ä½œå¯ä»¥å‚è€ƒ[appveyor-ymlçš„å‚è€ƒæ–‡æ¡£](https://www.appveyor.com/docs/appveyor-yml/), å…·ä½“çš„ä¹Ÿå¯ä»¥æŸ¥[appveyor docs](https://www.appveyor.com/docs/)

## åŸºæœ¬æµç¨‹
æ•´ä¸ªè¿‡ç¨‹æ˜¯è¿™æ ·çš„:
1. ä½ æ·»åŠ è‡ªå·±çš„GitHubä»“åº“å, appveyorä¼šè‡ªåŠ¨åˆ°è¯¥GitHubä»“åº“çš„è®¾ç½®é‡Œæ·»åŠ ä¸€ä¸ªwebhook(è§¦å‘äº‹ä»¶é»˜è®¤ä¸ºPull requestå’ŒPush), ä¸å½“å‰çš„appveyoré¡¹ç›®ç»‘å®š, æ‰€ä»¥æ¯å½“ä½ æœ‰æ–°çš„æ¨é€æ—¶, GitHubä¼šè‡ªåŠ¨è§¦å‘è¯¥webhook;
2. appveyoré¡¹ç›®è¢«è§¦å‘åä¼šå…ˆè°ƒç”¨GitHubå®˜æ–¹çš„apiæŸ¥çœ‹è¯¥repoæ ¹ç›®å½•ä¸‹æ˜¯å¦æœ‰appveyor.ymlé…ç½®æ–‡ä»¶, å¦‚æœæœ‰å°±å…ˆåªä¸‹è½½è¯¥æ–‡ä»¶å¯¹é¡¹ç›®ç¯å¢ƒè¿›è¡Œé…ç½®, ç„¶åcloneè¯¥repo, å†è¿›è¡Œé¡¹ç›®çš„æ•´ä¸ªbuild;å¦‚æœæ²¡æœ‰é…ç½®æ–‡ä»¶åˆ™é»˜è®¤ä½¿ç”¨msbuild, å³UIé…ç½®, è¿™éœ€è¦ä½ é¢„å…ˆåœ¨é¡¹ç›®è®¾ç½®é‡Œè¿›è¡Œé…ç½®.
3. ä»€ä¹ˆ?UIé…ç½®å’Œyamlé…ç½®èƒ½ä¸èƒ½å…±å­˜?ä½ é—®è¿™ä¸ªå•Š, å®˜æ–¹æ–‡æ¡£é‡Œå†™çš„å¾ˆæ¸…æ¥šäº†:
{%note info%}
Itâ€™s worth noticing that both appveyor.yml and UI configuration are mutually exclusive. Itâ€™s always either YAML or UI - the settings from each are not merged. If you have appveyor.yml in your repo it will override all settings made on the UI unless explicitly disabled by Ignore appveyor.yml. There are few exceptions,  which are:
1.Environment variables. Variables defined on UI are getting merged with those ones defined in appveyor.yml. Variable values with the same names are getting overridden with values from UI.
2.Notification settings defined on UI are getting merged with those ones defined in appveyor.yml.
3.Build version format is taken from UI if it is not set in appveyor.yml.
{%endnote%}
ç®€è€Œè¨€ä¹‹å°±æ˜¯, äºŒè€…ä¸èƒ½å…±å­˜(ä¸èƒ½åˆå¹¶), yamlé…ç½®æ–‡ä»¶çš„ä¼˜å…ˆçº§æ›´é«˜, å¦‚æœæœ‰yamlé…ç½®åˆ™UIé…ç½®ä¼šå…¨éƒ¨å¤±æ•ˆ(é™¤éä½ åœ¨UIé…ç½®é‡Œé€‰æ‹©å¿½ç•¥yamlé…ç½®æ–‡ä»¶), å½“ç„¶, é™¤äº†æœ€ååˆ—å‡ºçš„ä¸‰ç‚¹ä¾‹å¤–(ç¯å¢ƒå˜é‡`[ä¸¤è€…éƒ½æœ‰åˆ™åˆå¹¶]`, æé†’`[ä¸¤è€…éƒ½æœ‰åˆ™åˆå¹¶]`å’Œbuildç‰ˆæœ¬`[yamlæ²¡å†™è€ŒUIé…ç½®äº†åˆ™ç”¨UIçš„]`).

# ä¸‰. è¦æ¨é€artifactsæ€ä¹ˆåŠ
å¦‚æœä½ éœ€è¦åœ¨buildå®Œæˆä¹‹åå°†æˆåŠŸç”Ÿæˆçš„äº§å“å‘å¸ƒ/æ¨é€åˆ°ä½ çš„GitHubä»“åº“çš„è¯, é‚£å°±è¿˜éœ€è¦è¿›ä¸€æ­¥è®¾ç½®.åœ¨å®˜æ–¹æ–‡æ¡£çš„[Git push from build](https://www.appveyor.com/docs/how-to/git-push/)ä¹Ÿè¯´æ˜äº†, è¿™é‡Œæˆ‘ä»¥hexoåšå®¢ä¸ºä¾‹è¿›è¡Œå…·ä½“è¯´æ˜, æˆ‘åˆ›å»ºäº†hexoæºç åº“ä¸é™æ€é¡µé¢åº“ä¸¤ä¸ªrepo(å½“ç„¶ä½ ä¹Ÿå¯ä»¥éƒ½æ”¾åœ¨ä¸€ä¸ªrepoä¸­, åˆ†æˆä¸¤ä¸ªbranchå°±å¯ä»¥äº†), å°†æºç å’Œåšå®¢ç«™ç‚¹åˆ†å¼€, æƒ³è¦çš„æ•ˆæœæ˜¯: æˆ‘ä¸»åŠ¨æ¨é€æ›´æ–°åˆ°æºç åº“ä¸­ä¹‹å, appveyorè‡ªåŠ¨æ‹‰å–å¸®æˆ‘ç”Ÿæˆé™æ€é¡µé¢ç„¶åæ¨åˆ°é™æ€é¡µé¢åº“ä¸­, è¿™æ ·åšå®¢ç«™ç‚¹å°±è‡ªåŠ¨æ›´æ–°äº†, è¿™ä¸ªè¿‡ç¨‹å¤§æ¦‚æ˜¯:
1. hexoæºç åº“æ›´æ–°åè§¦å‘webhook;
2. appveyoré¡¹ç›®è‡ªåŠ¨æ‹‰å–appveyor.ymlå¯¹ç¯å¢ƒè¿›è¡Œé…ç½®, ç„¶åcloneé¡¹ç›®;
3. åœ¨`install`éƒ¨åˆ†ç”¨npmå®‰è£…ä¸€ç³»åˆ—ä¾èµ–, åœ¨`build_script`éƒ¨åˆ†ç”Ÿæˆé™æ€é¡µé¢, åœ¨`on_success`éƒ¨åˆ†å®šä¹‰ç”ŸæˆæˆåŠŸåè¿›è¡Œæ¨é€çš„æ­¥éª¤;
4. buildå…¶å®ä¸»è¦æ˜¯`hexo g`æ¥ç”Ÿæˆé™æ€é¡µé¢, ä¹Ÿå¯èƒ½ä½ éœ€è¦åæœŸå¤„ç†ä¸€ä¸‹(å¦‚å‹ç¼©ä»£ç ), å®Œæˆbuildåä¼šå°†ä¹‹å‰å®šä¹‰çš„artifactsæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹(åœ¨è¿™é‡Œæ˜¯publicæ–‡ä»¶å¤¹, å³é™æ€é¡µé¢ç”Ÿæˆåå­˜æ”¾çš„æ–‡ä»¶å¤¹)æ¨é€åˆ°é™æ€é¡µé¢åº“ä¸­, å¤§åŠŸå‘Šæˆ

å…¶å®, æ•´ä¸ªè¿‡ç¨‹å’Œä¸Šé¢çš„åŸºæœ¬æµç¨‹ç›¸æ¯”ä¹Ÿå°±æ˜¯å¤šäº†ä¸€ä¸ªæ¨é€çš„æ­¥éª¤è€Œå·², æƒ³æƒ³, å¦‚æœä½ éœ€è¦commitåˆ°ä»“åº“, é™¤äº†ç™»å½•åˆ°GitHubè¿˜èƒ½ç”¨ä»€ä¹ˆåŠæ³•?é‚£å°±æ˜¯OAuth tokenäº†, ä¹Ÿå°±æ˜¯personal access token, èƒ½å¤Ÿé€šè¿‡GitHubè®¤è¯, æ‹¿åˆ°ç”¨æˆ·å®Œå…¨çš„æ“ä½œæƒé™.

å…·ä½“çš„æ“ä½œå¦‚ä¸‹:

* 1.ç”Ÿæˆpersonal access token
åŸºæœ¬æ“ä½œ, ä¸ä¼šçš„è¯·å‚è€ƒ[å®˜æ–¹æ–‡æ¡£](https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/)
ä¿å­˜ç”Ÿæˆçš„token,ç­‰ä¼šç”¨
* 2.åŠ å¯†ç”Ÿæˆçš„token
åˆ°[AppveyoråŠ å¯†é¡µé¢](https://ci.appveyor.com/tools/encrypt)å¯¹åˆšåˆšç”Ÿæˆçš„tokenè¿›è¡ŒåŠ å¯†(åŠ å¯†åçš„tokenæ‰èƒ½æ”¾å¿ƒçš„å†™åˆ°appveyor.ymlé…ç½®æ–‡ä»¶é‡Œ)
å¯¹äºè¿™ä¸ª`Encrypt data`, å®˜æ–¹æ–‡æ¡£é‡Œä¹Ÿæœ‰[è¯´æ˜åœ¨æ­¤](https://www.appveyor.com/docs/build-configuration/#secure-variables).
ä¿å­˜åŠ å¯†çš„token,ç­‰ä¼šç”¨
* 3.é…ç½®æ–‡ä»¶
è¿™é‡Œæˆ‘ä¹Ÿæ˜¯åœ¨ç½‘ä¸Šå¤åˆ¶çš„é…ç½®æ–‡ä»¶,åæ­£æ¯”æˆ‘å†™çš„æ¡ç†å¤šäº†

```
clone_depth: 1

environment:
  access_token:
    secure: [å¡«ä¸ŠåˆšåˆšåŠ å¯†åçš„token]

install:
  - node --version
  - npm --version
  - npm install
  - npm install hexo-cli -g

build_script:
  - hexo g

artifacts:
  - path: public

on_success:
  - git config --global credential.helper store
  - ps: Add-Content "$env:USERPROFILE\.git-credentials" "https://$($env:access_token):x-oauth-basic@github.com`n"
  - git config --global user.email "%GIT_USER_EMAIL%"
  - git config --global user.name "%GIT_USER_NAME%"
  - git clone --depth 5 -q --branch=%TARGET_BRANCH% %STATIC_SITE_REPO% %TEMP%\static-site
  - cd %TEMP%\static-site
  - del * /f /q
  - for /d %%p IN (*) do rmdir "%%p" /s /q
  - SETLOCAL EnableDelayedExpansion & robocopy "%APPVEYOR_BUILD_FOLDER%\public" "%TEMP%\static-site" /e & IF !ERRORLEVEL! EQU 1 (exit 0) ELSE (IF !ERRORLEVEL! EQU 3 (exit 0) ELSE (exit 1))
  - git add -A
  - if "%APPVEYOR_REPO_BRANCH%"=="master" if not defined APPVEYOR_PULL_REQUEST_NUMBER (git diff --quiet --exit-code --cached || git commit -m "Update Static Site" && git push origin %TARGET_BRANCH% && appveyor AddMessage "Static Site Updated")
```
ç„¶ååœ¨UIè®¾ç½®çš„`Environment`é‡Œ,æ·»åŠ å››ä¸ªç¯å¢ƒå˜é‡:`STATIC_SITE_REPO`(æ˜¯è¦æäº¤åˆ°çš„repoåœ°å€,ä¹Ÿå°±æ˜¯æˆ‘é™æ€é¡µé¢åº“çš„åœ°å€)ï¼Œ`TARGET_BRANCH`(repoåˆ†æ”¯,å¡«masterå³å¯)ï¼Œ`GIT_USER_EMAIL`(GitHubè´¦æˆ·çš„é‚®ç®±)å’Œ`GIT_USER_NAME`(GitHubè´¦å·ç”¨æˆ·å),è´´ä¸Šæˆ‘çš„ä¾›å‚è€ƒ:
![Alt text](https://cdn.safeandsound.cn/image/appveyor%E5%85%A5%E9%97%A8/appveyor1.png)
å½“ç„¶, ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨é…ç½®æ–‡ä»¶é‡Œä¿®æ”¹, ç›´æ¥å°†ç¯å¢ƒå˜é‡æ”¹æˆç›¸åº”çš„å€¼å³å¯.

è¿™æ ·å†æ¨é€å°±å¯ä»¥çœ‹åˆ°appveyorè‡ªåŠ¨è¿›è¡Œbuildäº†.

# å››. èµ˜è¿°
## Artifactsçš„ä¿å­˜æ—¶é—´
å€¼å¾—ä¸€æçš„æ˜¯, è‡ª2018å¹´6æœˆ17å·èµ·, appveyorä¸Šé¡¹ç›®(ä¸è®ºç§æœ‰æˆ–æ˜¯å…¬æœ‰)çš„artifactsä¿ç•™çš„æ—¶é—´ä¸º6ä¸ªæœˆ, è¶…è¿‡å…­ä¸ªæœˆåˆ™ä¼šè¢«æ°¸ä¹…åˆ é™¤, è¯¦æƒ…è¯·è§å®˜æ–¹æ–‡æ¡£ ğŸ‘‰ [Artifacts retention policy](https://www.appveyor.com/docs/packaging-artifacts/#artifacts-retention-policy)

## "hexoåšå®¢è‡ªåŠ¨ç”Ÿæˆ"çš„npmç‰ˆæœ¬é—®é¢˜
ä½¿ç”¨appveyorè‡ªåŠ¨ç”Ÿæˆhexoåšå®¢é™æ€é¡µé¢æœŸé—´é‡åˆ°äº†æ¯”è¾ƒè¯¡å¼‚çš„æƒ…å†µ:æäº¤åæœ‰æ—¶å€™ä¼šbuildæˆåŠŸ, æœ‰æ—¶å€™ä¼šbuildå¤±è´¥, æœ‰æ—¶å€™å¤±è´¥äº†å†buildä¸€æ¬¡å°±æˆåŠŸäº†, æœ‰æ—¶å€™å¤±è´¥äº†å†buildå¥½å‡ æ¬¡æˆåŠŸä¸äº†, å®Œå…¨æ˜¯æ¦‚ç‡é—®é¢˜.ä»¥ä¸‹æ˜¯é”™è¯¯æ—¥å¿—:

```
npm ERR! Windows_NT 6.3.9600
npm ERR! argv "C:\\Program Files (x86)\\nodejs\\node.exe" "C:\\Program Files (x86)\\nodejs\\node_modules\\npm\\bin\\npm-cli.js" "install"
npm ERR! node v4.8.4
npm ERR! npm  v2.15.11
npm ERR! path C:\Users\appveyor\AppData\Roaming\npm-cache\lodash\4.17.4\package.tgz.904991043
npm ERR! code EPERM
npm ERR! errno -4048
npm ERR! syscall rename
npm ERR! Error: EPERM: operation not permitted, rename 'C:\Users\appveyor\AppData\Roaming\npm-cache\lodash\4.17.4\package.tgz.904991043' -> 'C:\Users\appveyor\AppData\Roaming\npm-cache\lodash\4.17.4\package.tgz'
npm ERR!     at Error (native)
npm ERR!  { [Error: EPERM: operation not permitted, rename 'C:\Users\appveyor\AppData\Roaming\npm-cache\lodash\4.17.4\package.tgz.904991043' -> 'C:\Users\appveyor\AppData\Roaming\npm-cache\lodash\4.17.4\package.tgz']
npm ERR!   errno: -4048,
npm ERR!   code: 'EPERM',
npm ERR!   syscall: 'rename',
npm ERR!   path: 'C:\\Users\\appveyor\\AppData\\Roaming\\npm-cache\\lodash\\4.17.4\\package.tgz.904991043',
npm ERR!   dest: 'C:\\Users\\appveyor\\AppData\\Roaming\\npm-cache\\lodash\\4.17.4\\package.tgz',
npm ERR!   parent: 'babel-traverse' }
npm ERR! 
npm ERR! Please try running this command again as root/Administrator.

```
çœ‹æ—¥å¿—å¥½åƒæ˜¯æƒé™çš„é—®é¢˜ï¼ŒGoogleäº†ä¸€ä¸‹, åœ¨appveyorå®˜æ–¹çš„githubè´¦æˆ·ä¸­çš„[è¯¥issue](https://github.com/appveyor/ci/issues/1058)ä¸­æåˆ°äº†å°†npmç‰ˆæœ¬å®‰è£…ä¸º5.3å³å¯:`npm -g install npm@5.3`ï¼Œåˆ°åº•è¿˜æ˜¯ç‰ˆæœ¬çš„é—®é¢˜

## appveyoråˆ›å»ºGité¡¹ç›®(égithub)ä¸GitHubæ–‡ä»¶ä¸‹è½½çš„APIè°ƒç”¨ç›¸å…³é—®é¢˜
å¦‚æœåˆ›å»ºprojectæ—¶é€‰æ‹©çš„æ˜¯Git, å³ä½¿ç”¨Clone URLçš„æ–¹å¼æ·»åŠ git repoæ¥åˆ›å»ºé¡¹ç›®çš„è¯, é‚£ä¹ˆæºé¡¹ç›®ä¸­å³ä¾¿æœ‰appveyor.ymlé…ç½®æ–‡ä»¶ä¹Ÿæ— æ³•ä½¿ç”¨, å…¶åŸå› è¢«æˆ‘åœ¨appveyorå®˜æ–¹githubçš„[ä¸€ä¸ªissueä¸­](https://github.com/appveyor/ci/issues/1309#issuecomment-278821821)æ‰¾åˆ°, å› ä¸ºé…ç½®æ–‡ä»¶çš„å·¥ä½œåŸç†æ˜¯appveyoråœ¨buildåˆ›å»ºä¹‹å‰é€šè¿‡Githubç­‰æ‰˜ç®¡æ–¹æä¾›çš„APIå…ˆå°†é…ç½®æ–‡ä»¶ä¸‹è½½ä¸‹æ¥å†è‡ªåŠ¨å¯¹è¿è¡Œç¯å¢ƒè¿›è¡Œé…ç½®, è€Œæ˜¯ä½¿ç”¨è¿™ä¸ªAPIæ˜¯éœ€è¦access tokençš„, å½“ç„¶, ä½ å¯èƒ½è¦é—®"ä¸ºä»€ä¹ˆä¸ç›´æ¥å»ä¸‹appveyor.ymlæ–‡ä»¶?è€Œéè¦ä½¿ç”¨APIå‘¢?åƒoctotreeä¸€ç±»çš„æ’ä»¶ä¸å°±æ˜¯å¯ä»¥ç›´æ¥ä¸‹è½½ä¹ˆ?"å¯æ˜¯[octotree](https://github.com/buunguyen/octotree)çš„é¡¹ç›®ä¸­ä¹Ÿè¯´äº†å®ƒä¹Ÿæ˜¯ç”¨çš„api:
{%note info%}
Octotree uses GitHub API to retrieve repository metadata. By default,  it makes unauthenticated requests to the GitHub API. However,  there are two situations when requests must be authenticated:
1.You access a private repository
2.You exceed the rate limit of unauthenticated requests
When that happens,  Octotree will ask for your GitHub personal access token. If you don't already have one,  create one,  then copy and paste it into the textbox. Note that the minimal scopes that should be granted are public_repo and repo (if you need access to private repositories).
{%endnote%}
å…³äºAPIè°ƒç”¨é€Ÿç‡é™åˆ¶çš„[githubå®˜æ–¹è¯´æ˜](https://developer.github.com/v3/#rate-limiting), ç®€è€Œè¨€ä¹‹, æœªç™»å½•åˆ™å¯¹ipè¿›è¡Œé™åˆ¶, æ¯å°æ—¶60æ¬¡;ä½¿ç”¨ç™»å½•è®¤è¯æˆ–OAuth tokenåˆ™å¯¹ç”¨æˆ·è¿›è¡Œé™åˆ¶, æ¯å°æ—¶5000æ¬¡;æ‰€ä»¥å¦‚æœappveyorè¦ä½¿ç”¨APIçš„è¯è‚¯å®šæ˜¯ä½¿ç”¨è®¤è¯çš„æ–¹å¼.
å†å›åˆ°gitæ–¹å¼åˆ›å»ºçš„é¡¹ç›®æ— æ³•ä½¿ç”¨é…ç½®æ–‡ä»¶çš„é—®é¢˜ä¸Š, ä½ å¯èƒ½è¦é—®"æ—¢ç„¶æˆ‘åœ¨appveyorçš„è´¦æˆ·é‡Œå¡«äº†æˆ‘çš„github personal access token, ä¸ºä»€ä¹ˆå®˜æ–¹ä¸åœ¨è¿™ä¸ªåˆ›å»ºæ–¹å¼ä¸Šåšäº›åˆ¤æ–­, æ£€æµ‹åˆ°æ˜¯GitHub/BitBucketç­‰çš„é¡¹ç›®å°±å¸¦ä¸Štokenå»æ‹‰", è¿™......ä½ è¿˜ä¸å¦‚ç™»å½•è‡ªå·±çš„GitHubè´¦å·ç›´æ¥forkè¿™ä¸ªé¡¹ç›®, ç„¶ååœ¨appveyoré‡Œé€‰æ‹©githubæ–¹å¼åˆ›å»ºé¡¹ç›®, ä¸‡äº‹å¤§å‰.
æ€»è€Œè¨€ä¹‹, å¦‚æœä½¿ç”¨gitæ–¹å¼åˆ›å»ºé¡¹ç›®çš„è¯, å°±åªèƒ½ä½¿ç”¨GUIçš„æ–¹å¼æ¥é…ç½®é¡¹ç›®, ä¸èƒ½åœ¨gitä»“åº“é‡Œä½¿ç”¨é…ç½®æ–‡ä»¶çš„æ–¹å¼.