---
title: Dockerå­¦ä¹ ç¬”è®°ï¼šåŸºç¡€å‘½ä»¤
urlname: Dockerå­¦ä¹ ç¬”è®°ï¼šåŸºç¡€å‘½ä»¤
date: 2017-12-23 17:19:41
tags: [docker]
---

æœ¬æ–‡è®°å½•äº†æˆ‘å¯¹dockeråŸºç¡€å‘½ä»¤çš„å­¦ä¹ , å¹¶è‡ªå·±æ­å»ºäº†ä¸€ä¸ªå°çš„ç¤ºä¾‹åº”ç”¨é›†ç¾¤.
![Docker logo](https://cdn.safeandsound.cn/image/docker/docker.jpg)

<!--more-->

[dockerå®˜ç½‘]:  https://www.docker.com/
[docker store]: https://store.docker.com/
[docker hub]: https://hub.docker.com/
[wikiä»‹ç»]: https://zh.wikipedia.org/wiki/Docker_(è»Ÿé«”)

### dockerç›¸å…³äº§å“ç®€ä»‹
å…³äºdockerçš„[wikiä»‹ç»]ã€‚[dockerå®˜ç½‘]åœ¨æ­¤ã€‚

[docker hub]æ˜¯dockerå…¬å¸æä¾›çš„å…¬å…±registry, æœ‰ç‚¹ç±»ä¼¼äºGitHub, ç”¨æˆ·å¯ä»¥å°†è‡ªå·±çš„é•œåƒå…è´¹ä¿å­˜åˆ°å…¬å…±ä»“åº“é‡Œ, å…¬å…±ä»“åº“ä¸é™, æ¯äººæœ‰ä¸€ä¸ªå…è´¹çš„ç§æœ‰ä»“åº“, å½“ç„¶ä½ ä¹Ÿå¯ä»¥è´­ä¹°æ›´å¤š.

[docker store]ä¸­çš„äº§å“éƒ½æ˜¯é€šè¿‡äº†dockerå®˜æ–¹è®¤è¯çš„, æ‰€ä»¥è‡³å°‘åœ¨å®˜æ–¹çœ‹æ¥è‚¯å®šæ˜¯å®‰å…¨çš„.
	
dockeræä¾›çš„è™šæ‹ŸåŒ–æ–¹å¼ä½¿å¾—æˆ‘ä»¬å¯ä»¥å¿«é€Ÿæ­å»ºå‡ºä¸€å¥—å¯å¤ç”¨çš„å¼€å‘ç¯å¢ƒ, è€Œä¸”dockeråœ¨ä»¥é•œåƒä¸ºåŸºç¡€æ„å»ºå‡ºçš„å®¹å™¨ååˆ†è½»é‡åŒ–, å¤§éƒ¨åˆ†å®¹å™¨åŸºæœ¬éƒ½å¯ä»¥å®ç°ç§’å¼€;å®ƒä»¥å®¹å™¨ä¸ºå¼€å‘, æµ‹è¯•å’Œå‘å¸ƒçš„å•å…ƒ, å°†æ‰€æœ‰ç›¸å…³çš„ç»„ä»¶å’Œç¯å¢ƒéƒ½å°è£…åˆ°å®¹å™¨ä¸­, è¿™æ ·å°±å·§å¦™çš„è§£å†³äº†å¼€å‘çš„åº”ç”¨åœ¨ä¸åŒå¹³å°ä¹‹é—´ä¾èµ–é—®é¢˜, ä¸”èƒ½ä¿è¯åº”ç”¨å³ä½¿åœ¨ä¸åŒå¹³å°ä¸‹çš„å®é™…ä½¿ç”¨ä¸­ä¹Ÿèƒ½è¾¾åˆ°é«˜åº¦ä¸€è‡´çš„æ•ˆæœ.

### æƒ…æ™¯ä¸¾ä¾‹
ä¸¾ä¸ªå¯èƒ½ä¸æ˜¯å¾ˆåˆé€‚çš„ä¾‹å­å§, æ¯”å¦‚ä»¥åå·¥ä½œ, æœ‰ä¸€å¤©å…­ç‚¹è¦ä¸‹ ç­äº†, è€æ¿çªç„¶æ‰“ç”µè¯æˆ‘è¯´"å“,æ–‡æ°, æ˜å¤©æœ‰ä¸€ä¸ªwebåº”ç”¨è¦æµ‹è¯•, æˆ‘ç»™ä½ ä¸€å°æœåŠ¡å™¨, ä½ ç°åœ¨ç®€å•éƒ¨ç½²ä¸€ä¸‹å§", é‚£æˆ‘è¿™(è¦)ä¹ˆ(æ¶¨)çƒ­(å·¥)å¿ƒ(èµ„), ä¸èƒ½æ‹’ç»å§, æ‹¿åˆ°åå°çš„ç¨‹åºä¸€çœ‹æ˜¯Javaå†™çš„, é‚£æˆ‘åœ¨æœåŠ¡å™¨ä¸Šèµ·ç å¾—è£…lnmpå’Œjreå§, å¥½çš„, å°±ç®—è£…çš„å¿«å§, é…ç½®ç¯å¢ƒåŠ ä¸Šéƒ¨ç½²å‰åç«¯å†ç®€å•æµ‹è¯•ä¸€ä¸‹åŠä¸ªå°æ—¶æå®š, æˆ‘è·Ÿè€æ¿è¯´å®Œæˆäº†. ç­‰æˆ‘æ”¶æ‹¾å®Œäº†è¦èµ°äº†, ä»–åˆæ‰“è¿‡æ¥è¯´, "å“å‘€,æé”™äº†, ç»™ä½ çš„é‚£å°æœåŠ¡å™¨æ˜¯è¿ç»´ä»–ä»¬ç”¨çš„, ä½ é‡æ–°å¼„ä¸€ä¸‹å§", äºæ˜¯æˆ‘åˆèŠ±äº†åŠä¸ªå°æ—¶é‡æ–°é…ç½®ç¯å¢ƒ&éƒ¨ç½², ç»ˆäºç»“æŸäº†, è€æ¿åˆè¯´"è¿™ä¸ªåº”ç”¨åœ¨æ˜å¤©æµ‹è¯•é‡Œä¹Ÿæœ‰å¯¹è´Ÿè½½æ–¹é¢çš„å‹åŠ›æµ‹è¯•, æˆ‘å†ç»™ä½ å››å°æœåŠ¡å™¨, ä½ éƒ¨ç½²ä¸€ä¸‹, å†åšä¸ªè´Ÿè½½å‡è¡¡å§"(è¿™æ—¶æˆ‘ä¼šæƒ³æ˜¯ä¸æ˜¯ä»–æ•…æ„é’ˆå¯¹æˆ‘), é‚£æˆ‘ä¼°è®¡ç…§æˆ‘ä¹‹å‰çš„æ–¹æ³•æ¥é…ç½®çš„è¯ä»Šæ™šæˆ‘å¾—å…«ä¹ç‚¹æ‰èƒ½å›å®¶äº†.

å½“ç„¶, è¿™ä¸ªä¾‹å­å¯èƒ½å¹¶ä¸å¥‘åˆç°å®(æ¯•ç«Ÿæˆ‘æ²¡æœ‰å®ä¹ è¿‡, å¹¶ä¸çŸ¥é“å…¬å¸çš„å®é™…ç”Ÿäº§ç¯å¢ƒ/æ“ä½œæµç¨‹å¦‚ä½•), ä½†æ˜¯æˆ‘ä»¬èƒ½å¤Ÿçœ‹å‡ºæ¥å¯¹äºè¿™ç§åœ¨ç”Ÿäº§ç¯å¢ƒé…ç½®ä¸Šçš„é‡å¤æ“ä½œ, åƒæˆ‘è¿™ç§ä¼ ç»Ÿçš„æ–¹æ³•æ˜¯å¾ˆæµªè´¹æ—¶é—´çš„, è€Œä¸”å¦‚æœå¯¹äºç”Ÿäº§ç¯å¢ƒè¿˜å­˜åœ¨ç‰ˆæœ¬æ–¹é¢çš„è¦æ±‚, é‚£ä¹ˆåœ¨ä»Šåçš„ç»´æŠ¤ä¸éƒ¨ç½²ä¼šæ›´åŠ éº»çƒ¦, é¡¹ç›®çš„æŒç»­äº¤ä»˜ä¸æŒç»­éƒ¨ç½²è¿‡ç¨‹ä¸­å¯èƒ½è¿˜å­˜åœ¨ç‰ˆæœ¬å›æ»šçš„é—®é¢˜.

è¿™æ—¶, dockerå°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©, æˆ‘ä»¬å¯ä»¥åœ¨ä¸€å°æœºå™¨ä¸Šæ„å»ºéœ€è¦çš„é•œåƒ, ç„¶åå‘å¸ƒæˆ‘ä»¬é•œåƒ, å†åœ¨å…¶ä»–çš„ä¸»æœºä¸Šæ‹‰å–é•œåƒå¹¶è¿›è¡Œéƒ¨ç½².

### dockerå‘½ä»¤çš„å­¦ä¹ 
æˆ‘æ˜¯å‚è€ƒç€[Dockerâ€”â€”å®¹å™¨ä¸å®¹å™¨äº‘(ç¬¬2ç‰ˆ)](https://book.douban.com/subject/26894736/)å­¦ä¹ çš„dockerå‘½ä»¤, å¦‚æœæ²¡æœ‰ä¹¦çš„è¯å¯ä»¥å‚è€ƒ[æ­¤æ–‡](https://www.jianshu.com/p/7c9e2247cfbd)ä¸­çš„å‘½ä»¤è®²è§£

### æ­å»ºä¸€ä¸ªå°çš„åº”ç”¨é›†ç¾¤
æˆ‘ä»¬ç°åœ¨æ­å»ºä¸€ä¸ªåå°æ˜¯java,å‰ç«¯æ˜¯phpè„šæœ¬ä¸åå°äº¤äº’, ä½¿ç”¨haproxyè¿›è¡Œè´Ÿè½½å‡è¡¡çš„ä¸€ä¸ªæ·»åŠ ç”¨æˆ·çš„å°åº”ç”¨.
å†…å®¹åªæ±‚ç®€å•, ä¸»è¦æ˜¯ç†è§£å¯¹dockerçš„æ“ä½œ.

è¿™é‡Œçš„ç¤ºä¾‹æ˜¯åœ¨linuxç¯å¢ƒä¸‹è¿›è¡Œçš„ã€‚
é¦–å…ˆå»ºè®®å°†dockerçš„é•œåƒæºæ›´æ¢ä¸ºå›½å†…çš„, è¿™æ ·èƒ½å¤§å¤§æé«˜ä¸‹è½½é€Ÿåº¦(æˆ‘è¿™é‡Œæ›´æ¢çš„æ˜¯ä¸­ç§‘å¤§çš„æº,å°¤å…¶æ˜¯ç”¨å­¦æ ¡çš„æœåŠ¡å™¨ğŸ™ˆæ•™è‚²ç½‘å†…ä¼ æ’­,é€Ÿåº¦ç›¸å½“å¿«äº†):

```
echo '{"registry-mirrors": ["https://docker.mirrors.ustc.edu.cn"]}' > /etc/docker/daemon.json
```

å¦‚æœæ˜¯windowsçš„ç¯å¢ƒåˆ™éœ€è¦åœ¨å›¾å½¢åŒ–ç•Œé¢çš„`docker -> setting -> daemon -> Registry mirrors`é‡Œé¢è¿›è¡Œè®¾ç½®æ·»åŠ 

#### åˆ›å»ºå®¹å™¨
æ¥ä¸‹æ¥åˆ›å»ºæˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„å®¹å™¨:

```
#åˆ›å»ºmysqlå®¹å™¨, é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡"MYSQL_ROOT_PASSWORD"æ¥è®¾ç½®rootç”¨æˆ·å¯†ç ,  
#æœ€åçš„ä¸¤ä¸ªå‚æ•°æ˜¯è®¾ç½®ç¼–ç çš„,  å¦åˆ™æŒä¹…åŒ–åˆ°æ•°æ®åº“çš„ä¸­æ–‡å°†æˆä¹±ç 
docker run -d --name mysql --env MYSQL_ROOT_PASSWORD=123456 mysql --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci

#åˆ›å»ºjavaå®¹å™¨ç”¨æ¥è¿è¡Œæˆ‘ä»¬çš„javaåå°,å°†å…¶8080ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„8080ç«¯å£,
#ä½¿ç”¨--linkå‚æ•°å°†å…¶ä¸mysqlå®¹å™¨é“¾æ¥,ä½¿äºŒè€…å¯ä»¥é€šä¿¡
#å°†Dç›˜çš„/forDocker/javaç›®å½•æŒ‚è½½åˆ°å…¶/root/javaç›®å½•, æ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œæ–‡ä»¶çš„ä¼ è¾“
docker run -itd --name java -p 8080:8080 -v /root/forDocker/java:/root/java --link mysql:mysql java 

#åˆ›å»ºä¸€ä¸ªphpå®¹å™¨æ¥è¿è¡Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå‰ç«¯ æœåŠ¡å™¨,å…¶8081ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„8081ç«¯å£,
#ä½¿ç”¨--linkå‚æ•°å°†å…¶ä¸javaå®¹å™¨é“¾æ¥,ä½¿äºŒè€…å¯ä»¥é€šä¿¡,
#å°†Dç›˜çš„/forDocker/php-app1ç›®å½•æŒ‚è½½åˆ°å…¶/root/php-app1ç›®å½•, æ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œæ–‡ä»¶çš„ä¼ è¾“
docker run -itd --name php-app1 -p 8081:8081 -v /root/forDocker/php-app1:/root/php-app1 --link java:java php 

#åˆ›å»ºå¦å¤–ä¸€ä¸ªphpå®¹å™¨æ¥è¿è¡Œæˆ‘ä»¬çš„ç¬¬äºŒä¸ªå‰ç«¯ æœåŠ¡å™¨,å…¶8082ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„8082ç«¯å£,
#ä½¿ç”¨--linkå‚æ•°å°†å…¶ä¸javaå®¹å™¨é“¾æ¥,ä½¿äºŒè€…å¯ä»¥é€šä¿¡,
#å°†Dç›˜çš„/forDocker/php-app2ç›®å½•æŒ‚è½½åˆ°å…¶/root/php-app2ç›®å½•, æ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œæ–‡ä»¶çš„ä¼ è¾“
docker run -itd --name php-app2 -p 8082:8082 -v /root/forDocker/php-app2:/root/php-app2 --link java:java php 
```

#### é…ç½®åç«¯å®¹å™¨
è¿™é‡Œæˆ‘ç”¨springç®€å•å†™äº†ä¸ªæ·»åŠ ç”¨æˆ·çš„ç¨‹åº, [é¡¹ç›®åœ°å€](https://github.com/VanjayDo/store/tree/master/app-addUser), å‰åç«¯éƒ½åœ¨é¡¹ç›®ä¸­(å‰ç«¯åœ¨webæ–‡ä»¶å¤¹ä¸­,ç”¨phpå†™çš„), å¦‚æœä½ æœ¬åœ°æœ‰java/mysql/phpçš„å¼€å‘ç¯å¢ƒ, å¯ä»¥é…ç½®ä¸€ä¸‹é¡¹ç›®åè·‘ä¸€æ¬¡è¯•è¯•, å¦‚æœæ²¡æœ‰, æˆ‘ä»¬ä¸‹é¢å°±è¦ä½¿ç”¨dockerè¿›è¡Œéƒ¨ç½²äº†.

é¦–å…ˆé’ˆå¯¹æˆ‘ä»¬çš„javaåç«¯ç¨‹åº, æˆ‘ä»¬è¦å…ˆè¿›å…¥mysqlå®¹å™¨æ–°å»ºä¸€ä¸ªæˆ‘ä»¬è¦ä½¿ç”¨çš„æ•°æ®åº“, ä½¿ç”¨å‘½ä»¤`docker exec -it mysql mysql -uroot -p123456`è¿›å…¥mysqlå, ä½¿ç”¨å‘½ä»¤`create database test;`åˆ›å»ºåä¸ºtestçš„æ•°æ®åº“.
ç„¶åæˆ‘ä»¬éœ€è¦çŸ¥é“mysqlå®¹å™¨çš„ipåœ°å€, ä½¿ç”¨å‘½ä»¤`docker inspect mysql|grep '"IPAddress":'`, æˆ‘ä»¬å°†æŸ¥å‡ºæ¥çš„IPåœ°å€(ä¾‹å¦‚172.17.0.2)å¡«å…¥é¡¹ç›®é…ç½®æ–‡ä»¶`src/main/resources/application.yml`ä¸­çš„spring > datasource > urlé…ç½®é¡¹ä¸­ï¼Œéœ€åŠ åè®®å¤´å’Œåœ¨åé¢æŒ‡å‡ºæ•°æ®åº“(å¦‚jdbc:mysql://172.17.0.2/test)ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬è¦å°†springé¡¹ç›®æ‰“åŒ…ï¼Œè¿™é‡Œä½¿ç”¨mavenæ„å»ºå·¥å…·, åœ¨é¡¹ç›®æ ¹æ–‡ä»¶å¤¹ä¸‹ä½¿ç”¨å‘½ä»¤`mvn package -D skipTests`è¿›è¡Œæ‰“åŒ…å¤„ç†, å¾—åˆ°target/test-0.0.1-SNAPSHOT.jaræ–‡ä»¶, å°†å…¶æ”¾åˆ°/root/forDocker/javaä¸‹, è¿è¡Œå‘½ä»¤`docker exec -d java java -jar /root/java/test-0.0.1-SNAPSHOT.jar`, è¿™æ ·åå°ç¨‹åºå°±åœ¨è¿è¡Œäº†.

#### é…ç½®å‰ç«¯å®¹å™¨
ç„¶åæˆ‘ä»¬éœ€è¦åœ¨phpå®¹å™¨ä¸­è¿è¡Œå‰ç«¯çš„é¡µé¢, é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨å‘½ä»¤`docker inspect java|grep '"IPAddress":'`å¾—åˆ°javaå®¹å™¨çš„ipåœ°å€(ä¾‹å¦‚172.17.0.3), ç„¶åä½¿ç”¨å‘½ä»¤`docker inspect php-app1|grep '"IPAddress":'`å’Œ`docker inspect php-app2|grep '"IPAddress":'`åˆ†åˆ«å¾—åˆ°ä¸¤ä¸ªphpå®¹å™¨çš„ipåœ°å€(ä¾‹å¦‚172.17.0.4å’Œ172.17.0.5), ç„¶åæˆ‘ä»¬ä¿®æ”¹web/index.phpæ–‡ä»¶:
åœ¨`<h3>æ·»åŠ ä¸€ä¸ªç”¨æˆ·</h3>`ä¸Šæ–¹æ·»åŠ `<h1>è¿™æ˜¯php-app1</h1>`ç„¶åå°†æ‰€æœ‰çš„`http://localhost:8080`éƒ½æ›¿æ¢ä¸º`http://172.17.0.3:8080`(è¿™æ˜¯javaå®¹å™¨çš„åœ°å€)å…±ä¸¤å¤„, æˆåŠŸåå°†å…¶ä¿å­˜å¹¶å¤åˆ¶åˆ°/root/forDocker/php-app1ç›®å½•ä¸‹,ç„¶åç»§ç»­ä¿®æ”¹,å°†`<h1>è¿™æ˜¯php-app1</h1>`ä¿®æ”¹ä¸º`<h1>è¿™æ˜¯php-app2</h1>`, ç„¶åä¿å­˜å¹¶å¤åˆ¶åˆ°/root/forDocker/php-app2

æ¥ä¸‹æ¥æˆ‘ä»¬è¿è¡Œä¸¤ä¸ªå®¹å™¨çš„å‰ç«¯è„šæœ¬, åˆ†åˆ«ä½¿ç”¨å‘½ä»¤`docker exec -d php-app1 php -S 172.17.0.4:8081 /root/php-app1/index.php`å’Œ`docker exec -d php-app2 php -S 172.17.0.5:8082 /root/php-app2/index.php`å,æˆ‘ä»¬åˆ†åˆ«è®¿é—®å®¿ä¸»æœºåœ°å€çš„8081å’Œ8082ç«¯å£, éƒ½å¯ä»¥çœ‹åˆ°å·²ç»å‡ºç°äº†ç›¸åº”çš„é¡µé¢,è€Œä¸”å·²ç»å¯ä»¥è¿›è¡Œç”¨æˆ·çš„æ·»åŠ æ“ä½œ.

#### è´Ÿè½½å‡è¡¡
å…¶å®åˆ°è¿™é‡Œä½ å·²ç»å¯¹dockerçš„æ“ä½œæœ‰äº†ä¸€å®šè®¤çŸ¥äº†, ä¸‹é¢æˆ‘ä»¬å†è¿›è¡Œä¸€ä¸ªç®€å•çš„é…ç½®, è¿›è¡Œä¸€ä¸‹è´Ÿè½½å‡è¡¡(å½“ç„¶äº†,è¿™é‡Œä¸¤ä¸ªå‰ç«¯å…±ç”¨ä¸€ä¸ªåå°, æ‰€ä»¥å¹¶æ²¡æœ‰å¤šå¤§çš„æ„ä¹‰, åªæ˜¯å¯¹äºå‰ç«¯çš„ä¸€ä¸ªåˆ†æµè€Œå·²):
è¿™é‡Œçš„è´Ÿè½½å‡è¡¡è½¯ä»¶æˆ‘ä½¿ç”¨çš„æ˜¯haproxy, ä¸ä»…å®Œå…¨å…è´¹è€Œä¸”åœ¨è´Ÿè½½å‡è¡¡æ–¹æ¡ˆä¸­ä¹Ÿæ˜¯å¾ˆé è°±çš„ä¸€ä¸ªé€‰æ‹©, æœ‰å…´è¶£çš„å¯ä»¥å»æ·±å…¥äº†è§£ä¸€ä¸‹
haproxy.cfgé…ç½®æ–‡ä»¶ï¼ˆè¿™é‡Œhaproxyå¹¶ä¸æ˜¯é‡ç‚¹ï¼Œæ‰€ä»¥å°±ä¸ç»†è¯´äº†ï¼Œç›´æ¥è´´å‡ºé…ç½®ï¼‰:

```
global
	log 127.0.0.1	local0
		maxconn		4096
		chroot	/usr/local/sbin
		daemon
		nbproc 4
		pidfile /usr/local/sbin/haproxy.pid

defaults
	log		127.0.0.1	local3
	mode	http
	option dontlognull
	retries 2
	maxconn 2000
	balance roundrobin

	timeout connect 5000ms
	timeout client 50000ms
	timeout server 50000ms

listen php_proxy
	bind *:8083
	stats enable
	stats uri /haproxy-stats
		server php-app1 php-app1:8081 check inter 2000 rise 2 fall 5
		server php-app2 php-app2:8082 check inter 2000 rise 2 fall 5
```

æˆ‘ä»¬å°†è¯¥æ–‡ä»¶ä¿å­˜åˆ°/root/forDocker/haproxyç›®å½•ä¸­, ç„¶åè¿è¡Œ

```
docker run -itd --name haproxy -p 8083:8083 -v /root/forDocker/haproxy:/usr/local/etc/haproxy --link php-app1:php-app1 --link php-app2:php-app2 haproxy
```
å¦‚æœæˆåŠŸçš„è¯, é‚£ä¹ˆè¿™æ—¶ä½ è®¿é—®å®¿ä¸»æœº8083ç«¯å£å¹¶ä¸åœçš„åˆ·æ–°é¡µé¢,ä¼šå‡ºç°php-app1å’Œphp-app2é¡µé¢è½®æµå‡ºç°çš„æƒ…å†µ(å› ä¸ºæˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶é‡Œé€‰æ‹©çš„è´Ÿè½½å‡è¡¡ç­–ç•¥æ˜¯roundrobin,å³ç®€å•çš„è½®è¯¢).

### æ„å»ºé•œåƒå¹¶æ¨é€åˆ°hub
æˆ‘ä»¬å¯ä»¥ç™»å½•æˆ‘ä»¬çš„docker hubè´¦å·, ä½¿ç”¨`docker login`å‘½ä»¤è¿›è¡Œç™»å½•æ“ä½œåå³å¯å°†æœ¬åœ°çš„å®¹å™¨æ‰“åŒ…æˆé•œåƒåæ¨é€åˆ°dockerHubè¿›è¡Œç®¡ç†.

åœ¨æ¨é€ä¹‹å‰, æˆ‘ä»¬éœ€è¦å…ˆå°†å®¹å™¨æ„å»ºæˆé•œåƒ, è¿™é‡Œä»¥æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„javaå®¹å™¨ä¸ºä¾‹: ä½¿ç”¨`docker commit java java:java-test`å‘½ä»¤è¿›è¡Œæ„å»º, ç°åœ¨æˆ‘ä»¬ä½¿ç”¨`docker images`å‘½ä»¤æŸ¥çœ‹æœ¬åœ°çš„æ‰€æœ‰é•œåƒä¼šå‘ç°å¤šäº†ä¸€ä¸ªä»“åº“åä¸ºjava,æ ‡ç­¾åä¸ºjava-testçš„é•œåƒ, ç±»ä¼¼:

```
REPOSITORY           TAG                 IMAGE ID            CREATED             SIZE
java                 java-test           6525b1d89a4e        12 minutes ago      643 MB
```

ç™»å½•dockerHubåæˆ‘ä»¬ç›´æ¥è¿›è¡Œæ¨é€è¯•è¯•,  `docker push java`, dockerçš„å®ˆæŠ¤è¿›ç¨‹æç¤ºerror:

```
Error response from daemon: You cannot push a "root" repository. Please rename your repository to docker.io/<user>/<repo> (ex: docker.io/yourusername/java)
```
è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç›´æ¥æ¨é€çš„è¯(æ­¤æ—¶æ²¡æœ‰æ‰“tagä¹Ÿæ²¡æœ‰æ³¨æ˜ç”¨æˆ·å), Dockerä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªrootä»“åº“ã€‚rootä»“åº“æ˜¯ç”±Dockerå…¬å¸çš„å›¢é˜Ÿç®¡ç†çš„, æ‰€ä»¥æ‹’ç»äº†æˆ‘ä»¬çš„æ¨é€è¯·æ±‚.

ç°åœ¨æˆ‘ä»¬åŠ ä¸Šç”¨æˆ·åå†è¯•è¯•`docker push yourusername/java`, ç»“æœæç¤ºæˆ‘ä»¬:

```
The push refers to a repository [docker.io/yourusername/java]
An image does not exist locally with the tag: docker.io/yourusername/java
```
æç¤ºä¿¡æ¯æ˜¾ç¤ºæœ¬åœ°å¹¶æ²¡æœ‰æ ‡ä¸Š`docker.io/yourusername/java`tagçš„é•œåƒ, è¿™æ˜¯å› ä¸ºä¹‹å‰æˆ‘ä»¬commitè¿›è¡Œæ„å»ºçš„æ—¶å€™æ²¡åŠ ä¸Šæˆ‘ä»¬çš„æˆ‘è‡ªå·±çš„ç”¨æˆ·å, è¿™æ ·æ¨çš„è¯è¿™ä¸ªé•œåƒçš„repoæ˜¯javaè€Œä¸æ˜¯yourusername/java, æ‰€ä»¥æˆ‘ä»¬éœ€è¦å†æ‰“ä¸€æ¬¡tagå°†repoæ”¹ä¸ºyourusername/java: `docker tag java:java-test yourusername/java:java-test`, è¿™æ ·å†ä½¿ç”¨`docker push yourusername/java`å°±å¯ä»¥äº†, æ‰€ä»¥ä½ çŸ¥é“äº†æœ€å¥½å°±æ˜¯åœ¨æ„å»ºçš„æ—¶å€™å°±åŠ ä¸Šè‡ªå·±çš„ç”¨æˆ·å, è¿™æ ·ä¸ç”¨äºŒæ¬¡æ‰“tagå°±èƒ½æ¨é€äº†.

æ¨é€å®Œæˆåå°±å¯ä»¥åœ¨ä½ çš„dockerHubé¡µé¢çœ‹åˆ°ç›¸å…³çš„é•œåƒäº†.

**æ³¨:**æ‰“tagçš„æ—¶å€™å¦‚æœä¸æ ‡æ˜çš„è¯é»˜è®¤æ˜¯lastest, rmiåˆ é™¤çš„æ—¶å€™é»˜è®¤ä¹Ÿæ˜¯lastest, æ‰€ä»¥å¦‚æœä½ çš„tagåå¹¶ä¸æ˜¯lastestè€Œåœ¨rmiçš„æ—¶å€™ä¸æ‰‹åŠ¨æ³¨æ˜tagçš„è¯, dockerä¼šæŠ¥é”™

### èµ˜è¿°
#### windowsä¸‹disk imageå†²çª
æœ‰æ—¶æˆ‘ä»¬ä¿®æ”¹äº†dockerè®¾ç½®ä¸­`disk image location`çš„ä½ç½®, åæ¥dockeråˆå› ä¸ºå´©æºƒè¢«æˆ‘ä»¬é‡ç½®äº†, é‡ç½®åé‡å¯dockeræˆ‘ä»¬ä¼šå‘ç°åŸæ¥çš„é•œåƒéƒ½æ²¡æœ‰äº†, æˆ‘ä»¬ä¿®æ”¹`disk image location`åˆ°ä¹‹å‰çš„ä½ç½®ä¹Ÿæ— æ³•æˆåŠŸ, å› ä¸ºåœ¨ç°åœ¨çš„dockerè®¾ç½®ä¸‹(imageé»˜è®¤å­˜æ”¾åœ¨C:\Users\Public\Documents\Hyper-V\Virtual Hard Disksæ–‡ä»¶å¤¹)æœ‰ä¸€ä¸ªMobyLinuxVM.vhdx, åŸæ¥æˆ‘ä»¬ä¿®æ”¹çš„åä¿å­˜çš„ä¹Ÿæœ‰ä¸€ä¸ªMobyLinuxVM.vhdx, ä¸¤ä¸ªé‡åæ–‡ä»¶è€Œä¸”æ— æ³•èåˆåœ¨ä¸€èµ·, dockerä¸çŸ¥é“å¦‚ä½•å»å¤„ç†, è¿™æ ·çš„æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥å…ˆé€€å‡ºdocker, ç„¶åå°†é»˜è®¤å­˜æ”¾æ–‡ä»¶å¤¹(C:\Users\Public\Documents\Hyper-V\Virtual Hard Disks)ä¸‹çš„MobyLinuxVM.vhdxåˆ é™¤, å†å°†ä¹‹å‰ä¿®æ”¹ä½ç½®çš„MobyLinuxVM.vhdxç§»åŠ¨åˆ°é»˜è®¤æ–‡ä»¶å¤¹ä¸‹, å†å¯åŠ¨docker, å°±å¯ä»¥ç»§ç»­ä½¿ç”¨åŸæ¥çš„imageäº†, ä½ ä¹Ÿå¯ä»¥é‡æ–°ä¿®æ”¹ `disk image location`çš„ä½ç½®